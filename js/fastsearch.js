var fuse,fuseIndex,searchVisible=!1,firstRun=!0,list=document.getElementById("searchResults"),first=list.firstChild,last=list.lastChild,maininput=document.getElementById("searchInput"),resultsAvailable=!1;document.addEventListener("keydown",function(e){e.ctrlKey&&e.which===70&&(e.preventDefault(),doSearch(e)),e.keyCode==27&&searchVisible&&(document.getElementById("fastSearch").style.visibility="hidden",document.activeElement.blur(),searchVisible=!1),e.keyCode==40&&searchVisible&&resultsAvailable&&(console.log("down"),e.preventDefault(),document.activeElement==maininput?first.focus():document.activeElement==last?last.focus():document.activeElement.parentElement.nextSibling.firstElementChild.focus()),e.keyCode==38&&searchVisible&&resultsAvailable&&(e.preventDefault(),document.activeElement==maininput?maininput.focus():document.activeElement==first?maininput.focus():document.activeElement.parentElement.previousSibling.firstElementChild.focus())}),document.getElementById("searchInput").onkeyup=function(){executeSearch(this.value)},document.querySelector("body").onclick=function(e){(e.target.tagName==="BODY"||e.target.tagName==="DIV")&&hideSearch()},document.querySelector("#search-btn").onclick=function(e){doSearch(e)};function doSearch(e){e.stopPropagation(),firstRun&&(loadSearch(),firstRun=!1),searchVisible?hideSearch():showSearch()}function hideSearch(){document.getElementById("fastSearch").style.visibility="hidden",document.activeElement.blur(),searchVisible=!1}function showSearch(){document.getElementById("fastSearch").style.visibility="visible",document.getElementById("searchInput").focus(),searchVisible=!0}function fetchJSONFile(e,t){var n=new XMLHttpRequest;n.onreadystatechange=function(){if(n.readyState===4&&n.status===200){var e=JSON.parse(n.responseText);t&&t(e)}},n.open("GET",e),n.send()}function loadSearch(){console.log("loadSearch()"),fetchJSONFile("/index.json",function(e){var t={shouldSort:!0,location:0,distance:100,threshold:.4,minMatchCharLength:2,keys:["permalink","title","tags","contents"]};fuseIndex=Fuse.createIndex(t.keys,e),fuse=new Fuse(e,t,fuseIndex)})}function executeSearch(e){let t=fuse.search(e),n="";if(t.length===0)resultsAvailable=!1,n="";else{permalinks=[],numLimit=5;for(let e in t){if(e>numLimit)break;if(permalinks.includes(t[e].item.permalink))continue;n=n+'<li><a href="'+t[e].item.permalink+'" tabindex="0"><span class="title">'+t[e].item.title+"</span></a></li>",permalinks.push(t[e].item.permalink)}resultsAvailable=!0}document.getElementById("searchResults").innerHTML=n,t.length>0&&(first=list.firstChild.firstElementChild,last=list.lastChild.firstElementChild)}
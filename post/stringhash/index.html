<!doctype html><html lang=zh-CN><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=author content="Find_NICK"><meta name=description content="字符串哈希,是一种能将字符串映射成非负整数的算法. 一般使用BKDR Hash进行哈希计算. 具体做法是,将字符串看作一个 $b$ 进制的数字,计算它在十"><link rel=icon href=https://findnick.top/favicon.ico><meta name=keywords content=" OI  code  algorithm "><meta property="og:title" content="字符串哈希"><meta property="og:description" content="字符串哈希,是一种能将字符串映射成非负整数的算法. 一般使用BKDR Hash进行哈希计算. 具体做法是,将字符串看作一个 $b$ 进制的数字,计算它在十"><meta property="og:type" content="article"><meta property="og:url" content="https://findnick.top/post/stringhash/"><meta property="article:section" content="post"><meta property="article:published_time" content="2023-09-17T21:27:58+08:00"><meta property="article:modified_time" content="2023-09-17T21:27:58+08:00"><link rel=canonical href=https://findnick.top/post/stringhash/><meta itemprop=name content="字符串哈希"><meta itemprop=description content="字符串哈希,是一种能将字符串映射成非负整数的算法. 一般使用BKDR Hash进行哈希计算. 具体做法是,将字符串看作一个 $b$ 进制的数字,计算它在十"><meta itemprop=datePublished content="2023-09-17T21:27:58+08:00"><meta itemprop=dateModified content="2023-09-17T21:27:58+08:00"><meta itemprop=wordCount content="519"><meta itemprop=keywords content><link media=screen rel=stylesheet href=https://findnick.top/css/common.css><link media=screen rel=stylesheet href=https://findnick.top/css/content.css><title>字符串哈希 - 0x3f</title>
<meta name=twitter:card content="summary"><meta name=twitter:title content="字符串哈希"><meta name=twitter:description content="字符串哈希,是一种能将字符串映射成非负整数的算法. 一般使用BKDR Hash进行哈希计算. 具体做法是,将字符串看作一个 $b$ 进制的数字,计算它在十"><link rel=stylesheet href=https://findnick.top/css/single.css><div id=wrapper><header id=header><h1><a href=https://findnick.top/>0x3f</a></h1><link href=/css/custom.css rel=stylesheet><link rel=stylesheet href=https://cdn.staticfile.org/KaTeX/0.16.8/katex.min.css crossorigin=anonymous><script defer src=https://cdn.staticfile.org/KaTeX/0.16.8/katex.min.js crossorigin=anonymous></script><script defer src=https://cdn.staticfile.org/KaTeX/0.16.8/contrib/auto-render.min.js crossorigin=anonymous></script><link rel=stylesheet href=https://cdn.staticfile.org/firacode/6.2.0/fira_code.min.css><link rel=stylesheet href="https://fonts.loli.net/css2?family=Noto+Serif+SC:wght@300;700&display=swap" crossorigin=anonymous><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}],ignoredTags:["script","noscript","style","textarea","pre","code","option"],throwOnError:!1})})</script><script defer src=https://cdn.staticfile.org/twikoo/1.6.20/twikoo.min.js></script><nav><span class=nav-bar-item><a class=link href=/>Post</a>
</span><span class=nav-bar-item><a class=link href=/post/>Archives</a>
</span><span class=nav-bar-item><a class=link href=/about/>About</a></span></nav></header><main id=main class=post><h1>字符串哈希</h1><article class=content><p>字符串哈希,是一种能将字符串映射成非负整数的算法.<p>一般使用BKDR Hash进行哈希计算.<p>具体做法是,将字符串看作一个 $b$ 进制的数字,计算它在十进制下的数值.<p>由于在字符串足够长时数字会过大,因此一般会取模一个大质数.<p>参考代码(只包含a-z的字符串):<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#2838b0>const</span> <span style=color:#2838b0;font-style:italic>int</span> mod<span style=color:#666>=</span><span style=color:#444>1e9</span><span style=color:#666>+</span><span style=color:#444>7</span><span style=color:#888>,</span>b<span style=color:#666>=</span><span style=color:#444>27</span><span style=color:#888>;</span>
</span></span><span style=display:flex><span><span style=color:#2838b0;font-style:italic>int</span> <span style=color:#785840>getstrhash</span><span style=color:#888>(</span>string str<span style=color:#888>){</span>
</span></span><span style=display:flex><span>    <span style=color:#2838b0;font-style:italic>int</span> len<span style=color:#666>=</span>str<span style=color:#888>.</span>size<span style=color:#888>();</span>
</span></span><span style=display:flex><span>    <span style=color:#2838b0;font-style:italic>int</span> ans<span style=color:#666>=</span><span style=color:#444>0</span><span style=color:#888>;</span>
</span></span><span style=display:flex><span>    <span style=color:#2838b0>for</span><span style=color:#888>(</span><span style=color:#2838b0;font-style:italic>int</span> i<span style=color:#666>=</span><span style=color:#444>0</span><span style=color:#888>;</span>i<span style=color:#666>&lt;</span>len<span style=color:#888>;</span>i<span style=color:#666>++</span><span style=color:#888>){</span>
</span></span><span style=display:flex><span>        ans<span style=color:#666>=</span><span style=color:#888>((</span><span style=color:#2838b0;font-style:italic>long</span> <span style=color:#2838b0;font-style:italic>long</span><span style=color:#888>)</span>ans<span style=color:#666>*</span>b<span style=color:#666>+</span><span style=color:#888>(</span>str<span style=color:#888>[</span>i<span style=color:#888>]</span><span style=color:#666>-</span><span style=color:#a848a8>&#39;a&#39;</span><span style=color:#666>+</span><span style=color:#444>1</span><span style=color:#888>))</span><span style=color:#666>%</span>mod<span style=color:#888>;</span>
</span></span><span style=display:flex><span>    <span style=color:#888>}</span>
</span></span><span style=display:flex><span>    <span style=color:#2838b0>return</span> ans<span style=color:#888>;</span>
</span></span><span style=display:flex><span><span style=color:#888>}</span>
</span></span></code></pre></div><blockquote><p>注意:如果使用上面的做法,注意是<code>str[i]-'a'+1</code>,否则<code>aab</code>和<code>ab</code>的哈希值相同.</blockquote><p>上面这种方法因为在实际使用时涉及到大量取模操作,所以通常利用<code>unsigned long long</code>类型溢出自动取模 $2^{64}-1$的性质,使用下面这种方法:<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#2838b0>const</span> <span style=color:#2838b0;font-style:italic>int</span> b<span style=color:#666>=</span><span style=color:#444>27</span><span style=color:#888>;</span>
</span></span><span style=display:flex><span><span style=color:#2838b0;font-style:italic>unsigned</span> <span style=color:#2838b0;font-style:italic>long</span> <span style=color:#2838b0;font-style:italic>long</span> <span style=color:#785840>getstrhash</span><span style=color:#888>(</span>string str<span style=color:#888>){</span>
</span></span><span style=display:flex><span>    <span style=color:#2838b0;font-style:italic>int</span> len<span style=color:#666>=</span>str<span style=color:#888>.</span>size<span style=color:#888>();</span>
</span></span><span style=display:flex><span>    <span style=color:#2838b0;font-style:italic>unsigned</span> <span style=color:#2838b0;font-style:italic>long</span> <span style=color:#2838b0;font-style:italic>long</span> ans<span style=color:#666>=</span><span style=color:#444>0</span><span style=color:#888>;</span>
</span></span><span style=display:flex><span>    <span style=color:#2838b0>for</span><span style=color:#888>(</span><span style=color:#2838b0;font-style:italic>int</span> i<span style=color:#666>=</span><span style=color:#444>0</span><span style=color:#888>;</span>i<span style=color:#666>&lt;</span>len<span style=color:#888>;</span>i<span style=color:#666>++</span><span style=color:#888>){</span>
</span></span><span style=display:flex><span>        ans<span style=color:#666>=</span>ans<span style=color:#666>*</span>b<span style=color:#666>+</span><span style=color:#888>(</span>str<span style=color:#888>[</span>i<span style=color:#888>]</span><span style=color:#666>-</span><span style=color:#a848a8>&#39;a&#39;</span><span style=color:#666>+</span><span style=color:#444>1</span><span style=color:#888>);</span>
</span></span><span style=display:flex><span>    <span style=color:#888>}</span>
</span></span><span style=display:flex><span>    <span style=color:#2838b0>return</span> ans<span style=color:#888>;</span>
</span></span><span style=display:flex><span><span style=color:#888>}</span>
</span></span></code></pre></div><p>求子串哈希<p>如果要计算子串哈希(比较子串是否相等),直接暴力计算,单次查询 $O(n)$ 复杂度.<p>使用类似前缀和的思想可以优化此过程.<p>具体做法是,预处理字符串(假设为str)的每个前缀哈希,利用求哈希时将字符串看作一个 $b$ 进制数的特点,将哈希值"左移"后相减.<p>例子:给定字符串 $s=&ldquo;abb&rdquo;$,求 $&ldquo;bb&rdquo;$ 的哈希值.<p>预处理出前缀哈希值<p>$pre[0]=1*27^0=1$<p>$pre[1]=1*27^1+2*27^0=29$<p>$pre[2]=1*27^2+2*27^1+2*27^0=785 $<p>然后结果为$pre[2]-pre[0]*27^2$.<p>参考代码<div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#2838b0;font-style:italic>int</span> <span style=color:#785840>getsubstrhash</span><span style=color:#888>(</span>string str<span style=color:#888>,</span><span style=color:#2838b0;font-style:italic>int</span> l<span style=color:#888>,</span><span style=color:#2838b0;font-style:italic>int</span> r<span style=color:#888>){</span>
</span></span><span style=display:flex><span>    <span style=color:#2838b0>return</span> pre<span style=color:#888>[</span>r<span style=color:#888>]</span><span style=color:#666>-</span>pre<span style=color:#888>[</span>l<span style=color:#666>-</span><span style=color:#444>1</span><span style=color:#888>]</span><span style=color:#666>*</span>powofbase<span style=color:#888>[</span>r<span style=color:#666>-</span>l<span style=color:#666>+</span><span style=color:#444>1</span><span style=color:#888>];</span>
</span></span><span style=display:flex><span>    <span style=color:#888;font-style:italic>//powofbase[i]为b的i次方
</span></span></span><span style=display:flex><span><span style=color:#888;font-style:italic></span><span style=color:#888>}</span>
</span></span></code></pre></div></article><div class=paginator><a class=link href=https://findnick.top/post/luogu-p1083/>← prev</a>
<a></a></div><div class=comment></div><style>.tk-footer{display:none!important}</style><div id=tcomment></div><script type=module>twikoo.init({envId:"https://twikoo.findnick.top/",el:"#tcomment"})</script></main><footer id=footer><div><span>© 2023</span> - <span>2023</span></div><div class=footnote><span></span></div></footer></div>